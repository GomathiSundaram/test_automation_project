Ind==Y records
  test_case_id                 validation_Type  ... min_val max_val
0          FM1                     count_check  ...       0       0
1          FM2                null_value_check  ...       0       0
2          FM3                uniqueness_check  ...       0       0
3          FM4                    data_compare  ...       0       0
4          FM5                       duplicate  ...       0       0
5          FM6  records_present_only_in_source  ...       0       0
6          FM7     records_present_only_target  ...       0       0
7          FM8                    schema_check  ...       0       0
8          FM9                      name_check  ...       0       0
9         FM10              column_range_check  ...       0       0

[10 rows x 23 columns]
+--------------------------------------+-----------+---------------------+--------------+------------------------+-----------------------------------+-----------------------------------------+------------+---------------------+--------------+------------------+--------------------------------+----------------------+-------------+----------------------------------------------------------+---------------+----------+---------------+--------+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|source                                |source_type|source_json_multiline|source_db_name|source_schema_path      |source_transformation_query_path   |target                                   |target_type |target_json_multiline|target_db_name|target_schema_path|target_transformation_query_path|key_col_list          |null_col_list|exclude_columns                                           |unique_col_list|dq_column |expected_values|min_val |max_val |validation_Type                                                                                                                                                                                                    |
+--------------------------------------+-----------+---------------------+--------------+------------------------+-----------------------------------+-----------------------------------------+------------+---------------------+--------------+------------------+--------------------------------+----------------------+-------------+----------------------------------------------------------+---------------+----------+---------------+--------+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|contact_info_bronze                   |snowflake  |NOT APPL             |snowflake_db  |NOT APPL                |contact_info_b2s_transformation.sql|contact_info_silver                      |snowflake_db|NOT APPL             |snowflake_db  |NOT APPL          |NOT APPL                        |IDENTIFIER,CURRENT_IND|identifier   |batch_date,create_date,update_date,create_user,update_user|identifier     |surname   |NOT APP        |0       |0       |[name_check]                                                                                                                                                                                                       |
|contact_info_bronze                   |snowflake  |NOT APPL             |snowflake_db  |NOT APPL                |contact_info_b2s_transformation.sql|contact_info_silver                      |snowflake_db|NOT APPL             |snowflake_db  |NOT APPL          |NOT APPL                        |IDENTIFIER,CURRENT_IND|identifier   |batch_date,create_date,update_date,create_user,update_user|identifier     |identifier|NOT APP        |1       |99999999|[column_range_check]                                                                                                                                                                                               |
|SAMPLEDB.CONTACT_INFO.CONTACT_INFO_RAW|snowflake  |NOT APPL             |snowflake_db  |NOT APPL                |contact_info_r2b.sql               |SAMPLEDB.CONTACT_INFO.CONTACT_INFO_BRONZE|snowflake   |NOT APPL             |snowflake_db  |NOT APPL          |NOT APPL                        |identifier            |identifier   |batch_date,create_date,update_date,create_user,update_user|identifier     |NOT APPL  |NOT APPL       |0       |0       |[data_compare, count_check, null_value_check, uniqueness_check, schema_check, name_check, duplicate, records_present_only_in_source, records_present_only_target, column_range_check]                              |
|contact_info_bronze                   |snowflake  |NOT APPL             |snowflake_db  |NOT APPL                |contact_info_b2s_transformation.sql|contact_info_silver                      |snowflake_db|NOT APPL             |snowflake_db  |NOT APPL          |NOT APPL                        |IDENTIFIER,CURRENT_IND|identifier   |batch_date,create_date,update_date,create_user,update_user|identifier     |NOT APP   |NOT APP        |0       |0       |[data_compare, count_check, null_value_check, uniqueness_check, schema_check, duplicate, records_present_only_in_source, records_present_only_target]                                                              |
|contact_info_bronze                   |snowflake  |NOT APPL             |snowflake_db  |NOT APPL                |contact_info_b2s_transformation.sql|contact_info_silver                      |snowflake_db|NOT APPL             |snowflake_db  |NOT APPL          |NOT APPL                        |IDENTIFIER,CURRENT_IND|identifier   |batch_date,create_date,update_date,create_user,update_user|identifier     |birthmonth|NOT APP        |19240101|20240101|[column_range_check]                                                                                                                                                                                               |
|contact_info_bronze                   |snowflake  |NOT APPL             |snowflake_db  |NOT APPL                |contact_info_b2s_transformation.sql|contact_info_silver                      |snowflake_db|NOT APPL             |snowflake_db  |NOT APPL          |NOT APPL                        |IDENTIFIER,CURRENT_IND|identifier   |batch_date,create_date,update_date,create_user,update_user|identifier     |state     |AP,KA,MH,KL,TN |0       |0       |[column_value_reference_check]                                                                                                                                                                                     |
|Contact_info_25092024.csv             |csv        |NOT APPL             |NOT APPL      |contact_info_schema.json|NOT APPL                           |SAMPLEDB.CONTACT_INFO.CONTACT_INFO_RAW   |snowflake   |NOT APPL             |snowflake_db  |NOT APPL          |NOT APPL                        |identifier            |identifier   |batch_date,create_date,update_date,create_user,update_user|identifier     |NOT APPL  |NOT APPL       |0       |0       |[data_compare, count_check, null_value_check, uniqueness_check, schema_check, name_check, column_value_reference_check, duplicate, records_present_only_in_source, records_present_only_target, column_range_check]|
|SAMPLEDB.CONTACT_INFO.CONTACT_INFO_RAW|snowflake  |NOT APPL             |snowflake_db  |NOT APPL                |contact_info_r2b.sql               |SAMPLEDB.CONTACT_INFO.CONTACT_INFO_BRONZE|snowflake   |NOT APPL             |snowflake_db  |NOT APPL          |NOT APPL                        |identifier            |identifier   |batch_date,create_date,update_date,create_user,update_user|identifier     |NOT APP   |NOT APP        |0       |0       |[column_value_reference_check]                                                                                                                                                                                     |
+--------------------------------------+-----------+---------------------+--------------+------------------------+-----------------------------------+-----------------------------------------+------------+---------------------+--------------+------------------+--------------------------------+----------------------+-------------+----------------------------------------------------------+---------------+----------+---------------+--------+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

testcases in list form [Row(source='contact_info_bronze', source_type='snowflake', source_json_multiline='NOT APPL', source_db_name='snowflake_db', source_schema_path='NOT APPL', source_transformation_query_path='contact_info_b2s_transformation.sql', target='contact_info_silver', target_type='snowflake_db', target_json_multiline='NOT APPL', target_db_name='snowflake_db', target_schema_path='NOT APPL', target_transformation_query_path='NOT APPL', key_col_list='IDENTIFIER,CURRENT_IND', null_col_list='identifier', exclude_columns='batch_date,create_date,update_date,create_user,update_user', unique_col_list='identifier', dq_column='surname', expected_values='NOT APP', min_val=0, max_val=0, validation_Type=['name_check']), Row(source='contact_info_bronze', source_type='snowflake', source_json_multiline='NOT APPL', source_db_name='snowflake_db', source_schema_path='NOT APPL', source_transformation_query_path='contact_info_b2s_transformation.sql', target='contact_info_silver', target_type='snowflake_db', target_json_multiline='NOT APPL', target_db_name='snowflake_db', target_schema_path='NOT APPL', target_transformation_query_path='NOT APPL', key_col_list='IDENTIFIER,CURRENT_IND', null_col_list='identifier', exclude_columns='batch_date,create_date,update_date,create_user,update_user', unique_col_list='identifier', dq_column='identifier', expected_values='NOT APP', min_val=1, max_val=99999999, validation_Type=['column_range_check']), Row(source='SAMPLEDB.CONTACT_INFO.CONTACT_INFO_RAW', source_type='snowflake', source_json_multiline='NOT APPL', source_db_name='snowflake_db', source_schema_path='NOT APPL', source_transformation_query_path='contact_info_r2b.sql', target='SAMPLEDB.CONTACT_INFO.CONTACT_INFO_BRONZE', target_type='snowflake', target_json_multiline='NOT APPL', target_db_name='snowflake_db', target_schema_path='NOT APPL', target_transformation_query_path='NOT APPL', key_col_list='identifier', null_col_list='identifier', exclude_columns='batch_date,create_date,update_date,create_user,update_user', unique_col_list='identifier', dq_column='NOT APPL', expected_values='NOT APPL', min_val=0, max_val=0, validation_Type=['data_compare', 'count_check', 'null_value_check', 'uniqueness_check', 'schema_check', 'name_check', 'duplicate', 'records_present_only_in_source', 'records_present_only_target', 'column_range_check']), Row(source='contact_info_bronze', source_type='snowflake', source_json_multiline='NOT APPL', source_db_name='snowflake_db', source_schema_path='NOT APPL', source_transformation_query_path='contact_info_b2s_transformation.sql', target='contact_info_silver', target_type='snowflake_db', target_json_multiline='NOT APPL', target_db_name='snowflake_db', target_schema_path='NOT APPL', target_transformation_query_path='NOT APPL', key_col_list='IDENTIFIER,CURRENT_IND', null_col_list='identifier', exclude_columns='batch_date,create_date,update_date,create_user,update_user', unique_col_list='identifier', dq_column='NOT APP', expected_values='NOT APP', min_val=0, max_val=0, validation_Type=['data_compare', 'count_check', 'null_value_check', 'uniqueness_check', 'schema_check', 'duplicate', 'records_present_only_in_source', 'records_present_only_target']), Row(source='contact_info_bronze', source_type='snowflake', source_json_multiline='NOT APPL', source_db_name='snowflake_db', source_schema_path='NOT APPL', source_transformation_query_path='contact_info_b2s_transformation.sql', target='contact_info_silver', target_type='snowflake_db', target_json_multiline='NOT APPL', target_db_name='snowflake_db', target_schema_path='NOT APPL', target_transformation_query_path='NOT APPL', key_col_list='IDENTIFIER,CURRENT_IND', null_col_list='identifier', exclude_columns='batch_date,create_date,update_date,create_user,update_user', unique_col_list='identifier', dq_column='birthmonth', expected_values='NOT APP', min_val=19240101, max_val=20240101, validation_Type=['column_range_check']), Row(source='contact_info_bronze', source_type='snowflake', source_json_multiline='NOT APPL', source_db_name='snowflake_db', source_schema_path='NOT APPL', source_transformation_query_path='contact_info_b2s_transformation.sql', target='contact_info_silver', target_type='snowflake_db', target_json_multiline='NOT APPL', target_db_name='snowflake_db', target_schema_path='NOT APPL', target_transformation_query_path='NOT APPL', key_col_list='IDENTIFIER,CURRENT_IND', null_col_list='identifier', exclude_columns='batch_date,create_date,update_date,create_user,update_user', unique_col_list='identifier', dq_column='state', expected_values='AP,KA,MH,KL,TN', min_val=0, max_val=0, validation_Type=['column_value_reference_check']), Row(source='Contact_info_25092024.csv', source_type='csv', source_json_multiline='NOT APPL', source_db_name='NOT APPL', source_schema_path='contact_info_schema.json', source_transformation_query_path='NOT APPL', target='SAMPLEDB.CONTACT_INFO.CONTACT_INFO_RAW', target_type='snowflake', target_json_multiline='NOT APPL', target_db_name='snowflake_db', target_schema_path='NOT APPL', target_transformation_query_path='NOT APPL', key_col_list='identifier', null_col_list='identifier', exclude_columns='batch_date,create_date,update_date,create_user,update_user', unique_col_list='identifier', dq_column='NOT APPL', expected_values='NOT APPL', min_val=0, max_val=0, validation_Type=['data_compare', 'count_check', 'null_value_check', 'uniqueness_check', 'schema_check', 'name_check', 'column_value_reference_check', 'duplicate', 'records_present_only_in_source', 'records_present_only_target', 'column_range_check']), Row(source='SAMPLEDB.CONTACT_INFO.CONTACT_INFO_RAW', source_type='snowflake', source_json_multiline='NOT APPL', source_db_name='snowflake_db', source_schema_path='NOT APPL', source_transformation_query_path='contact_info_r2b.sql', target='SAMPLEDB.CONTACT_INFO.CONTACT_INFO_BRONZE', target_type='snowflake', target_json_multiline='NOT APPL', target_db_name='snowflake_db', target_schema_path='NOT APPL', target_transformation_query_path='NOT APPL', key_col_list='identifier', null_col_list='identifier', exclude_columns='batch_date,create_date,update_date,create_user,update_user', unique_col_list='identifier', dq_column='NOT APP', expected_values='NOT APP', min_val=0, max_val=0, validation_Type=['column_value_reference_check'])]
########################################
source_file_path/table and type contact_info_bronze snowflake
target_file_path/table contact_info_silver snowflake_db
source db name snowflake_db
source trans query path contact_info_b2s_transformation.sql
transformation_query_path C:\Users\gomat\PycharmProjects\test_automation_project\transformation_queries\contact_info_b2s_transformation.sql
SELECT
    "Identifier",
    "Surname",
    "given_name",
    "middle_initial",
    "Primary_street_number",
    "primary_street_name",
    "city",
    "state",
    "zipcode",
    "Email",
     "phone"  ,
    "birthmonth",
    'Y' as "Current_ind",
    "batch_date",
    "create_date",
    "update_date",
    "create_user",
    "update_user"
FROM
     SAMPLEDB.CONTACT_INFO.contact_info_bronze
union all
SELECT
    "Identifier",
    "Surname",
    "given_name",
    "middle_initial",
    "Primary_street_number_prev",
    "primary_street_name_prev",
    "city_prev",
    "state_prev",
    "zipcode_prev",
    "Email",
     "phone"  ,
    "birthmonth",
    'N' as "Current_ind",
    "batch_date",
    "create_date",
    "update_date",
    "create_user",
    "update_user"
FROM
     SAMPLEDB.CONTACT_INFO.contact_info_bronze
